var requirejs,require,define;!function(global,setTimeout){function commentReplace(e,t){return t||""}function isFunction(e){return"[object Function]"===ostring.call(e)}function isArray(e){return"[object Array]"===ostring.call(e)}function each(e,t){var i;if(e)for(i=0;i<e.length&&(!e[i]||!t(e[i],i,e));i+=1);}function eachReverse(e,t){var i;if(e)for(i=e.length-1;i>-1&&(!e[i]||!t(e[i],i,e));i-=1);}function hasProp(e,t){return hasOwn.call(e,t)}function getOwn(e,t){return hasProp(e,t)&&e[t]}function eachProp(e,t){var i;for(i in e)if(hasProp(e,i)&&t(e[i],i))break}function mixin(e,t,i,s){return t&&eachProp(t,function(t,n){!i&&hasProp(e,n)||(!s||"object"!=typeof t||!t||isArray(t)||isFunction(t)||t instanceof RegExp?e[n]=t:(e[n]||(e[n]={}),mixin(e[n],t,i,s)))}),e}function bind(e,t){return function(){return t.apply(e,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(e){throw e}function getGlobal(e){if(!e)return e;var t=global;return each(e.split("."),function(e){t=t[e]}),t}function makeError(e,t,i,s){var n=new Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e);return n.requireType=e,n.requireModules=s,i&&(n.originalError=i),n}function newContext(e){function t(e,t,i){var s,n,r,o,a,l,h,c,u,p,d=t&&t.split("/"),f=x.map,m=f&&f["*"];if(e&&(l=(e=e.split("/")).length-1,x.nodeIdCompat&&jsSuffixRegExp.test(e[l])&&(e[l]=e[l].replace(jsSuffixRegExp,"")),"."===e[0].charAt(0)&&d&&(e=d.slice(0,d.length-1).concat(e)),function(e){var t,i;for(t=0;t<e.length;t++)if("."===(i=e[t]))e.splice(t,1),t-=1;else if(".."===i){if(0===t||1===t&&".."===e[2]||".."===e[t-1])continue;t>0&&(e.splice(t-1,2),t-=2)}}(e),e=e.join("/")),i&&f&&(d||m)){e:for(r=(n=e.split("/")).length;r>0;r-=1){if(a=n.slice(0,r).join("/"),d)for(o=d.length;o>0;o-=1)if((s=getOwn(f,d.slice(0,o).join("/")))&&(s=getOwn(s,a))){h=s,c=r;break e}!u&&m&&getOwn(m,a)&&(u=getOwn(m,a),p=r)}!h&&u&&(h=u,c=p),h&&(n.splice(0,c,h),e=n.join("/"))}return getOwn(x.pkgs,e)||e}function i(e){isBrowser&&each(scripts(),function(t){if(t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===v.contextName)return t.parentNode.removeChild(t),!0})}function s(e){var t=getOwn(x.paths,e);if(t&&isArray(t)&&t.length>1)return t.shift(),v.require.undef(e),v.makeRequire(null,{skipMap:!0})([e]),!0}function n(e){var t,i=e?e.indexOf("!"):-1;return i>-1&&(t=e.substring(0,i),e=e.substring(i+1,e.length)),[t,e]}function r(e,i,s,r){var o,a,l,h,c=null,u=i?i.name:null,p=e,d=!0,f="";return e||(d=!1,e="_@r"+(O+=1)),e=(h=n(e))[1],(c=h[0])&&(c=t(c,u,r),a=getOwn(P,c)),e&&(c?f=s?e:a&&a.normalize?a.normalize(e,function(e){return t(e,u,r)}):-1===e.indexOf("!")?t(e,u,r):e:(c=(h=n(f=t(e,u,r)))[0],s=!0,o=v.nameToUrl(f=h[1]))),{prefix:c,name:f,parentMap:i,unnormalized:!!(l=!c||a||s?"":"_unnormalized"+(k+=1)),url:o,originalName:p,isDefine:d,id:(c?c+"!"+f:f)+l}}function o(e){var t=e.id,i=getOwn(w,t);return i||(i=w[t]=new v.Module(e)),i}function a(e,t,i){var s=e.id,n=getOwn(w,s);!hasProp(P,s)||n&&!n.defineEmitComplete?(n=o(e)).error&&"error"===t?i(n.error):n.on(t,i):"defined"===t&&i(P[s])}function l(e,t){var i=e.requireModules,s=!1;t?t(e):(each(i,function(t){var i=getOwn(w,t);i&&(i.error=e,i.events.error&&(s=!0,i.emit("error",e)))}),s||req.onError(e))}function h(){globalDefQueue.length&&(each(globalDefQueue,function(e){var t=e[0];"string"==typeof t&&(v.defQueueMap[t]=!0),T.push(e)}),globalDefQueue=[])}function c(e){delete w[e],delete b[e]}function u(){var e,t,n=1e3*x.waitSeconds,r=n&&v.startTime+n<(new Date).getTime(),o=[],a=[],h=!1,c=!0;if(!y){if(y=!0,eachProp(b,function(e){var n=e.map,l=n.id;if(e.enabled&&(n.isDefine||a.push(e),!e.error))if(!e.inited&&r)s(l)?(t=!0,h=!0):(o.push(l),i(l));else if(!e.inited&&e.fetched&&n.isDefine&&(h=!0,!n.prefix))return c=!1}),r&&o.length)return(e=makeError("timeout","Load timeout for modules: "+o,null,o)).contextName=v.contextName,l(e);c&&each(a,function(e){!function e(t,i,s){var n=t.map.id;t.error?t.emit("error",t.error):(i[n]=!0,each(t.depMaps,function(n,r){var o=n.id,a=getOwn(w,o);!a||t.depMatched[r]||s[o]||(getOwn(i,o)?(t.defineDep(r,P[o]),t.check()):e(a,i,s))}),s[n]=!0)}(e,{},{})}),r&&!t||!h||!isBrowser&&!isWebWorker||S||(S=setTimeout(function(){S=0,u()},50)),y=!1}}function p(e){hasProp(P,e[0])||o(r(e[0],null,!0)).init(e[1],e[2])}function d(e,t,i,s){e.detachEvent&&!isOpera?s&&e.detachEvent(s,t):e.removeEventListener(i,t,!1)}function f(e){var t=e.currentTarget||e.srcElement;return d(t,v.onScriptLoad,"load","onreadystatechange"),d(t,v.onScriptError,"error"),{node:t,id:t&&t.getAttribute("data-requiremodule")}}function m(){var e;for(h();T.length;){if(null===(e=T.shift())[0])return l(makeError("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));p(e)}v.defQueueMap={}}var y,g,v,E,S,x={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},w={},b={},M={},T=[],P={},A={},C={},O=1,k=1;return E={require:function(e){return e.require?e.require:e.require=v.makeRequire(e.map)},exports:function(e){if(e.usingExports=!0,e.map.isDefine)return e.exports?P[e.map.id]=e.exports:e.exports=P[e.map.id]={}},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){return getOwn(x.config,e.map.id)||{}},exports:e.exports||(e.exports={})}}},(g=function(e){this.events=getOwn(M,e.id)||{},this.map=e,this.shim=getOwn(x.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0}).prototype={init:function(e,t,i,s){s=s||{},this.inited||(this.factory=t,i?this.on("error",i):this.events.error&&(i=bind(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=i,this.inited=!0,this.ignore=s.ignore,s.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,v.startTime=(new Date).getTime();var e=this.map;if(!this.shim)return e.prefix?this.callPlugin():this.load();v.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return e.prefix?this.callPlugin():this.load()}))}},load:function(){var e=this.map.url;A[e]||(A[e]=!0,v.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var e,t,i=this.map.id,s=this.depExports,n=this.exports,r=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(r)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{n=v.execCb(i,r,s,n)}catch(t){e=t}else n=v.execCb(i,r,s,n);if(this.map.isDefine&&void 0===n&&((t=this.module)?n=t.exports:this.usingExports&&(n=this.exports)),e)return e.requireMap=this.map,e.requireModules=this.map.isDefine?[this.map.id]:null,e.requireType=this.map.isDefine?"define":"require",l(this.error=e)}else n=r;if(this.exports=n,this.map.isDefine&&!this.ignore&&(P[i]=n,req.onResourceLoad)){var o=[];each(this.depMaps,function(e){o.push(e.normalizedMap||e)}),req.onResourceLoad(v,this.map,o)}c(i),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else hasProp(v.defQueueMap,i)||this.fetch()}},callPlugin:function(){var e=this.map,i=e.id,s=r(e.prefix);this.depMaps.push(s),a(s,"defined",bind(this,function(s){var n,h,u,p=getOwn(C,this.map.id),d=this.map.name,f=this.map.parentMap?this.map.parentMap.name:null,m=v.makeRequire(e.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(s.normalize&&(d=s.normalize(d,function(e){return t(e,f,!0)})||""),a(h=r(e.prefix+"!"+d,this.map.parentMap,!0),"defined",bind(this,function(e){this.map.normalizedMap=h,this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),void((u=getOwn(w,h.id))&&(this.depMaps.push(h),this.events.error&&u.on("error",bind(this,function(e){this.emit("error",e)})),u.enable()))):p?(this.map.url=v.nameToUrl(p),void this.load()):((n=bind(this,function(e){this.init([],function(){return e},null,{enabled:!0})})).error=bind(this,function(e){this.inited=!0,this.error=e,e.requireModules=[i],eachProp(w,function(e){0===e.map.id.indexOf(i+"_unnormalized")&&c(e.map.id)}),l(e)}),n.fromText=bind(this,function(t,s){var a=e.name,h=r(a),c=useInteractive;s&&(t=s),c&&(useInteractive=!1),o(h),hasProp(x.config,i)&&(x.config[a]=x.config[i]);try{req.exec(t)}catch(e){return l(makeError("fromtexteval","fromText eval for "+i+" failed: "+e,e,[i]))}c&&(useInteractive=!0),this.depMaps.push(h),v.completeLoad(a),m([a],n)}),void s.load(e.name,m,n,x))})),v.enable(s,this),this.pluginMaps[s.id]=s},enable:function(){b[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(e,t){var i,s,n;if("string"==typeof e){if(e=r(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[t]=e,n=getOwn(E,e.id))return void(this.depExports[t]=n(this));this.depCount+=1,a(e,"defined",bind(this,function(e){this.undefed||(this.defineDep(t,e),this.check())})),this.errback?a(e,"error",bind(this,this.errback)):this.events.error&&a(e,"error",bind(this,function(e){this.emit("error",e)}))}s=w[i=e.id],hasProp(E,i)||!s||s.enabled||v.enable(e,this)})),eachProp(this.pluginMaps,bind(this,function(e){var t=getOwn(w,e.id);t&&!t.enabled&&v.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var i=this.events[e];i||(i=this.events[e]=[]),i.push(t)},emit:function(e,t){each(this.events[e],function(e){e(t)}),"error"===e&&delete this.events[e]}},(v={config:x,contextName:e,registry:w,defined:P,urlFetched:A,defQueue:T,defQueueMap:{},Module:g,makeModuleMap:r,nextTick:req.nextTick,onError:l,configure:function(e){if(e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/"),"string"==typeof e.urlArgs){var t=e.urlArgs;e.urlArgs=function(e,i){return(-1===i.indexOf("?")?"?":"&")+t}}var i=x.shim,s={paths:!0,bundles:!0,config:!0,map:!0};eachProp(e,function(e,t){s[t]?(x[t]||(x[t]={}),mixin(x[t],e,!0,!0)):x[t]=e}),e.bundles&&eachProp(e.bundles,function(e,t){each(e,function(e){e!==t&&(C[e]=t)})}),e.shim&&(eachProp(e.shim,function(e,t){isArray(e)&&(e={deps:e}),!e.exports&&!e.init||e.exportsFn||(e.exportsFn=v.makeShimExports(e)),i[t]=e}),x.shim=i),e.packages&&each(e.packages,function(e){var t;t=(e="string"==typeof e?{name:e}:e).name,e.location&&(x.paths[t]=e.location),x.pkgs[t]=e.name+"/"+(e.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}),eachProp(w,function(e,t){e.inited||e.map.unnormalized||(e.map=r(t,null,!0))}),(e.deps||e.callback)&&v.require(e.deps||[],e.callback)},makeShimExports:function(e){return function(){var t;return e.init&&(t=e.init.apply(global,arguments)),t||e.exports&&getGlobal(e.exports)}},makeRequire:function(s,n){function a(t,i,h){var c,p,d;return n.enableBuildCallback&&i&&isFunction(i)&&(i.__requireJsBuild=!0),"string"==typeof t?isFunction(i)?l(makeError("requireargs","Invalid require call"),h):s&&hasProp(E,t)?E[t](w[s.id]):req.get?req.get(v,t,s,a):(p=r(t,s,!1,!0),hasProp(P,c=p.id)?P[c]:l(makeError("notloaded",'Module name "'+c+'" has not been loaded yet for context: '+e+(s?"":". Use require([])")))):(m(),v.nextTick(function(){m(),(d=o(r(null,s))).skipMap=n.skipMap,d.init(t,i,h,{enabled:!0}),u()}),a)}return n=n||{},mixin(a,{isBrowser:isBrowser,toUrl:function(e){var i,n=e.lastIndexOf("."),r=e.split("/")[0];return-1!==n&&(!("."===r||".."===r)||n>1)&&(i=e.substring(n,e.length),e=e.substring(0,n)),v.nameToUrl(t(e,s&&s.id,!0),i,!0)},defined:function(e){return hasProp(P,r(e,s,!1,!0).id)},specified:function(e){return e=r(e,s,!1,!0).id,hasProp(P,e)||hasProp(w,e)}}),s||(a.undef=function(e){h();var t=r(e,s,!0),n=getOwn(w,e);n.undefed=!0,i(e),delete P[e],delete A[t.url],delete M[e],eachReverse(T,function(t,i){t[0]===e&&T.splice(i,1)}),delete v.defQueueMap[e],n&&(n.events.defined&&(M[e]=n.events),c(e))}),a},enable:function(e){getOwn(w,e.id)&&o(e).enable()},completeLoad:function(e){var t,i,n,r=getOwn(x.shim,e)||{},o=r.exports;for(h();T.length;){if(null===(i=T.shift())[0]){if(i[0]=e,t)break;t=!0}else i[0]===e&&(t=!0);p(i)}if(v.defQueueMap={},n=getOwn(w,e),!t&&!hasProp(P,e)&&n&&!n.inited){if(!(!x.enforceDefine||o&&getGlobal(o)))return s(e)?void 0:l(makeError("nodefine","No define call for "+e,null,[e]));p([e,r.deps||[],r.exportsFn])}u()},nameToUrl:function(e,t,i){var s,n,r,o,a,l,h=getOwn(x.pkgs,e);if(h&&(e=h),l=getOwn(C,e))return v.nameToUrl(l,t,i);if(req.jsExtRegExp.test(e))o=e+(t||"");else{for(s=x.paths,r=(n=e.split("/")).length;r>0;r-=1)if(a=getOwn(s,n.slice(0,r).join("/"))){isArray(a)&&(a=a[0]),n.splice(0,r,a);break}o=n.join("/"),o=("/"===(o+=t||(/^data\:|^blob\:|\?/.test(o)||i?"":".js")).charAt(0)||o.match(/^[\w\+\.\-]+:/)?"":x.baseUrl)+o}return x.urlArgs&&!/^blob\:/.test(o)?o+x.urlArgs(e,o):o},load:function(e,t){req.load(v,e,t)},execCb:function(e,t,i,s){return t.apply(s,i)},onScriptLoad:function(e){if("load"===e.type||readyRegExp.test((e.currentTarget||e.srcElement).readyState)){interactiveScript=null;var t=f(e);v.completeLoad(t.id)}},onScriptError:function(e){var t=f(e);if(!s(t.id)){var i=[];return eachProp(w,function(e,s){0!==s.indexOf("_@r")&&each(e.depMaps,function(e){if(e.id===t.id)return i.push(s),!0})}),l(makeError("scripterror",'Script error for "'+t.id+(i.length?'", needed by: '+i.join(", "):'"'),e,[t.id]))}}}).require=v.makeRequire(),v}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(e){if("interactive"===e.readyState)return interactiveScript=e}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.3.5",commentRegExp=/\/\*[\s\S]*?\*\/|([^:"'=]|^)\/\/.*$/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if(void 0===define){if(void 0!==requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}void 0===require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(e,t,i,s){var n,r,o=defContextName;return isArray(e)||"string"==typeof e||(r=e,isArray(t)?(e=t,t=i,i=s):e=[]),r&&r.context&&(o=r.context),(n=getOwn(contexts,o))||(n=contexts[o]=req.s.newContext(o)),r&&n.configure(r),n.require(e,t,i)},req.config=function(e){return req(e)},req.nextTick=void 0!==setTimeout?function(e){setTimeout(e,4)}:function(e){e()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(e){req[e]=function(){var t=contexts[defContextName];return t.require[e].apply(t,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],(baseElement=document.getElementsByTagName("base")[0])&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(e,t,i){var s=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return s.type=e.scriptType||"text/javascript",s.charset="utf-8",s.async=!0,s},req.load=function(e,t,i){var s,n=e&&e.config||{};if(isBrowser)return(s=req.createNode(n,t,i)).setAttribute("data-requirecontext",e.contextName),s.setAttribute("data-requiremodule",t),!s.attachEvent||s.attachEvent.toString&&s.attachEvent.toString().indexOf("[native code")<0||isOpera?(s.addEventListener("load",e.onScriptLoad,!1),s.addEventListener("error",e.onScriptError,!1)):(useInteractive=!0,s.attachEvent("onreadystatechange",e.onScriptLoad)),s.src=i,n.onNodeCreated&&n.onNodeCreated(s,n,t,i),currentlyAddingScript=s,baseElement?head.insertBefore(s,baseElement):head.appendChild(s),currentlyAddingScript=null,s;if(isWebWorker)try{setTimeout(function(){},0),importScripts(i),e.completeLoad(t)}catch(s){e.onError(makeError("importscripts","importScripts failed for "+t+" at "+i,s,[t]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(e){if(head||(head=e.parentNode),dataMain=e.getAttribute("data-main"))return mainScript=dataMain,cfg.baseUrl||-1!==mainScript.indexOf("!")||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0}),define=function(e,t,i){var s,n;"string"!=typeof e&&(i=t,t=e,e=null),isArray(t)||(i=t,t=null),!t&&isFunction(i)&&(t=[],i.length&&(i.toString().replace(commentRegExp,commentReplace).replace(cjsRequireRegExp,function(e,i){t.push(i)}),t=(1===i.length?["require"]:["require","exports","module"]).concat(t))),useInteractive&&(s=currentlyAddingScript||getInteractiveScript())&&(e||(e=s.getAttribute("data-requiremodule")),n=contexts[s.getAttribute("data-requirecontext")]),n?(n.defQueue.push([e,t,i]),n.defQueueMap[e]=!0):globalDefQueue.push([e,t,i])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this,"undefined"==typeof setTimeout?void 0:setTimeout);var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function s(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(s.prototype=i.prototype,new s)}}();define("services/key-status",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this.keys={17:!1,65:!1,87:!1,68:!1,83:!1,13:!1,69:!1,32:!1,37:!1,38:!1,39:!1,40:!1}}return e.prototype.keyChange=function(e,t){this.keys[e]=t},e.prototype.isLeft=function(){return this.keys[37]},e.prototype.isRight=function(){return this.keys[39]},e.prototype.isUp=function(){return this.keys[38]},e.prototype.isDown=function(){return this.keys[40]},e.prototype.isShooting=function(){return this.keys[32]},e.prototype.isFireZeMissiles=function(){return this.keys[17]},e}();t.KeyDown=i}),define("model/entity",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})}),define("model/user",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,i,s,n){this.color=e,this.width=t,this.height=i,this.x=s,this.y=n,this.Color=e,this.Width=t,this.Height=i,this.X=s,this.Y=n,this.sprite=new Image}return e.prototype.draw=function(e){e.fillStyle=this.color,e.drawImage(this.sprite,this.X,this.Y,this.width,this.height)},e.prototype.explode=function(){return this.health--,this.health<=0},e.prototype.update=function(e,t,i){},e}();t.User=i}),define("model/projectile",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this.Color="fff",this.Width=30,this.Height=15,this.active=!0,this.powerup=!1,this.sprite=new Image}return e.prototype.draw=function(e){e.fillStyle=this.Color,e.drawImage(this.sprite,this.X,this.Y,this.Width,this.Height)},e.prototype.explode=function(){this.active=!1},e.prototype.update=function(e,t,i){this.inBounds(e)?this.X-=this.Speed*i:this.active=!1},e.prototype.inBounds=function(e){return this.X>=0&&this.X<=e.canvas.width&&this.Y>=0&&this.Y<=e.canvas.height},e}();t.Projectile=i}),define("services/asset-manager",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(t.ASSETS||(t.ASSETS={})).PREPEND="./assets/"}),define("model/playerBullets",["require","exports","model/projectile","services/asset-manager"],function(e,t,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(t,i,n){var r=e.call(this)||this;return r.bulletCycle=128*Math.random(),r.X=i,r.Y=n,r.Speed=t,r.sprite.src=s.ASSETS.PREPEND+"drone-images/bullet1.png",r}return __extends(t,e),t.prototype.powerUpCycle=function(){this.Y+=3*Math.sin(this.bulletCycle*Math.PI/60),this.bulletCycle++},t}(i.Projectile);t.PlayerBullets=n}),define("model/player",["require","exports","model/user","model/playerBullets","services/asset-manager"],function(e,t,i,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){var t=e.call(this,"fff",90,40,200,200)||this;return t.shieldSpriteNum=1,t.shieldTick=10,t.playerVelocity=250,t.maxHealth=60,t.baseSprite=n.ASSETS.PREPEND+"drone-images/playerShip1.png",t.health=50,t.hasSprayPowerUp=!1,t.hasShield=!1,t.hasExplosionVelocity=!1,t.hasRoFpowerUp=!1,t.sprite.src=t.baseSprite,t}return __extends(t,e),t.prototype.update=function(e,t,i){t.isDown()&&(this.Y+=this.Y>e.canvas.height-20?0:this.playerVelocity*i),t.isUp()&&(this.Y-=this.Y<0?0:this.playerVelocity*i),t.isLeft()&&(this.X-=this.X<0?0:this.playerVelocity*i),t.isRight()&&(this.X+=this.X>e.canvas.width-20?0:this.playerVelocity*i),this.hasShield&&this.shieldTick<=0&&(clearInterval(this.loopShieldSprites),this.hasShield=!1,this.sprite.src=this.baseSprite)},t.prototype.midpoint=function(){return{x:this.X+this.Width/2,y:this.Y+this.Height/2}},t.prototype.shoot=function(e){var t=this.midpoint();return e.push(new s.PlayerBullets(-750,t.x,t.y)),e},t.prototype.explode=function(){if(!this.hasShield)return this.hasSprayPowerUp=!1,this.health--,this.health<=0;this.shieldTick--},t.prototype.addHealth=function(e){this.health+=e,this.health>this.maxHealth&&(this.health=this.maxHealth)},t.prototype.activateShield=function(){var e=this;clearInterval(this.loopShieldSprites),this.shieldTick=10,this.hasShield=!0,this.loopShieldSprites=setInterval(function(){e.shieldSpriteNum++,6===e.shieldSpriteNum&&(e.shieldSpriteNum=1),e.sprite.src=n.ASSETS.PREPEND+"drone-images/playerShip-shield-"+e.shieldSpriteNum+".png"},80)},t.prototype.losePowerUps=function(){this.hasSprayPowerUp=!1,this.hasExplosionVelocity=!1,this.hasRoFpowerUp=!1},t.prototype.draw=function(e){e.drawImage(this.sprite,this.X,this.Y,this.Width,this.Height)},t}(i.User);t.Player=r}),define("model/enemy-drones",["require","exports","model/projectile","services/asset-manager"],function(e,t,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(t,i,n){var r=e.call(this)||this;return r.X=i,r.Y=n,r.Speed=t,r.Width=50,r.Height=30,r.age=Math.floor(128*Math.random()),r.hasBeenShot=!1,r.sprite.src=s.ASSETS.PREPEND+"drone-images/alienship1.png",r}return __extends(t,e),t.prototype.update=function(e,t,i){this.inBounds(e)?(this.X-=this.Speed*i,this.Y+=3*Math.sin(this.age*Math.PI/128),this.age++):this.active=!1},t.prototype.explode=function(){var e=this;this.hasBeenShot=!0,this.sprite.src=s.ASSETS.PREPEND+"drone-images/explode2.png",setTimeout(function(){e.active=!1},250)},t}(i.Projectile);t.Enemy=n}),define("model/powerups",["require","exports","model/user","services/asset-manager"],function(e,t,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=function(e){function t(){var t=e.call(this,"aaa",50,41,0,200)||this;return t.showText=!1,t.active=!1,t.getNewType(),t}return __extends(t,e),t.prototype.update=function(e,t,i){this.inBounds(e)?this.X-=200*i:(this.active=!1,this.X=e.canvas.width)},t.prototype.inBounds=function(e){return this.X>=0&&this.X<=e.canvas.width&&this.Y>=0&&this.Y<=e.canvas.height},t.prototype.getNewType=function(){var e=100*Math.random();e>=0&&e<20?(this.sprite.src=s.ASSETS.PREPEND+"drone-images/powerup-spray.png",this.type=n.Spray):e>=20&&e<40?(this.sprite.src=s.ASSETS.PREPEND+"drone-images/powerup-health.png",this.type=n.Health):e>=40&&e<60?(this.sprite.src=s.ASSETS.PREPEND+"drone-images/powerup-explosionVelocity.png",this.type=n.explosionVelocity):e>=60&&e<80?(this.sprite.src=s.ASSETS.PREPEND+"drone-images/powerup-shield.png",this.type=n.Shield):e>=80&&(this.sprite.src=s.ASSETS.PREPEND+"drone-images/powerup-rOf.png",this.type=n.RoF)},t.prototype.getFlashText=function(){switch(this.showType){case n.Spray:return"Main Weapon Upgrade!";case n.Health:return"+10 Health!";case n.explosionVelocity:return"Increase Missile Damage";case n.RoF:return"Rate of Fire Increase";case n.Shield:return"Shields!";default:return""}},t.prototype.flashInfo=function(e){var t=this;this.showType=e,this.showText=!0,setTimeout(function(){t.showText=!1},2e3)},t}(i.User);t.Powerup=r,function(e){e[e.Spray=0]="Spray",e[e.Health=1]="Health",e[e.explosionVelocity=2]="explosionVelocity",e[e.RoF=3]="RoF",e[e.Shield=4]="Shield"}(n=t.PowerUpType||(t.PowerUpType={}))}),define("model/missile",["require","exports","model/user","services/asset-manager"],function(e,t,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(t){var i=e.call(this,"fff",60,30,0,0)||this;return i.activeMissile=!1,i.missileVelocity=450,i.defaultExplosionVelocity=100,i.explodingMissile=!1,i.defaultSprite=s.ASSETS.PREPEND+"drone-images/missile1.png",i.powerupSprite=s.ASSETS.PREPEND+"drone-images/missile1-powerup.png",i.explodingSprite=s.ASSETS.PREPEND+"drone-images/explode3.png",i.needMissile=!1,i.sprite.src=t?i.powerupSprite:i.defaultSprite,i.explosionVelocity=t?400:i.defaultExplosionVelocity,i}return __extends(t,e),t.prototype.update=function(e,t,i){this.inBounds(e)?this.X+=this.missileVelocity*i:this.activeMissile=!1},t.prototype.inBounds=function(e){return this.X>=0&&this.X<=e.canvas.width&&this.Y>=0&&this.Y<=e.canvas.height},t.prototype.destroy=function(e){var t=this;this.activeMissile=!1,this.explodingMissile=!0,this.Width=200,this.Height=200,this.sprite.src=this.explodingSprite,setTimeout(function(){t.explodingMissile=!1,t.needMissile=!0,t.sprite.src=t.defaultSprite},200)},t}(i.User);t.Missile=n}),define("model/enemyBullets",["require","exports","model/projectile","services/asset-manager"],function(e,t,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(t,i,n){var r=e.call(this)||this;return r.bulletCycle=128*Math.random(),r.X=i,r.Y=n,r.Speed=t,r.sprite.src=s.ASSETS.PREPEND+"drone-images/bossBullet1.png",r}return __extends(t,e),t.prototype.powerUpCycle=function(){this.Y+=3*Math.sin(this.bulletCycle*Math.PI/128),this.bulletCycle++},t}(i.Projectile);t.EnemyBullet=n}),define("model/boss.drones",["require","exports","model/user","model/enemyBullets","services/asset-manager"],function(e,t,i,s,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){var t=e.call(this,"fff",200,100,0,300)||this;return t.active=!1,t.bossVelocity=80,t.defaultSprite=n.ASSETS.PREPEND+"drone-images/boss1.png",t.health=100,t.sprite.src=t.defaultSprite,t}return __extends(t,e),t.prototype.update=function(e,t,i){t.isDown()&&(this.Y+=this.Y>e.canvas.height-e.canvas.height/4?0:this.bossVelocity*i),t.isUp()&&(this.Y-=this.Y<0?0:this.bossVelocity*i),t.isLeft()&&(this.X-=this.X<0?0:this.bossVelocity*i),t.isRight()&&(this.X+=this.X>e.canvas.width-e.canvas.width/4?0:this.bossVelocity*i)},t.prototype.midpoint=function(){return{x:this.X+this.Width/2,y:this.Y+this.Height/2}},t.prototype.shoot=function(e){var t=this.midpoint();return e.push(new s.EnemyBullet(550,t.x,t.y)),e},t.prototype.destroy=function(e){var t=this;this.active=!1,this.explodingBoss=!0,this.sprite.src=n.ASSETS.PREPEND+"drone-images/explode3.png",setTimeout(function(){t.explodingBoss=!1,t.sprite.src=t.defaultSprite},300)},t}(i.User);t.Boss=r}),define("model/CanvasMenuObjects",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasShape=function(e,t,i,s){this.x=e,this.y=t,this.w=i,this.h=s},t.CanvasText=function(e,t,i,s,n){this.word=e,this.x=t,this.y=i,this.color=s,this.font=n}}),define("model/hud",["require","exports","services/asset-manager","model/CanvasMenuObjects"],function(e,t,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.showLevelText="Level 1",this.volOn=i.ASSETS.PREPEND+"drone-images/volume.png",this.volPaused=i.ASSETS.PREPEND+"drone-images/volume-pause.png",this.textColor="lime",this.volumeImageObj=new Image(25,25),this.volumeImageObj.src=this.volOn,this.nextImageObj=new Image(25,25),this.nextImageObj.src=i.ASSETS.PREPEND+"drone-images/volumeNext.jpg",this.createGUI()}return e.prototype.displayText=function(e,t){var i=new s.CanvasText(t,e.canvas.width/2,e.canvas.height/6,this.textColor,"25px Jazz LET, fantasy");e.font=i.font,e.fillStyle=i.color,e.textAlign="center",e.fillText(t,i.x,i.y)},e.prototype.playerStats=function(e,t,i){var n=new s.CanvasText("Health: "+t.health.toString(),e.canvas.width/40,e.canvas.height-e.canvas.height/14,this.textColor,"17px Jazz LET, fantasy"),r=new s.CanvasText("Kills: "+i.toString(),e.canvas.width/40,e.canvas.height-e.canvas.height/10,this.textColor,"17px Jazz LET, fantasy"),o=new s.CanvasText(this.showLevelText,e.canvas.width/40,e.canvas.height-e.canvas.height/7,this.textColor,"17px Jazz LET, fantasy");e.font=n.font,e.fillStyle=this.textColor,e.strokeStyle=this.textColor,e.textAlign="left",e.fillText(n.word,n.x,n.y),e.fillText(r.word,r.x,r.y),e.fillText(o.word,o.x,o.y)},e.prototype.drawShieldTick=function(e,t){var i=new s.CanvasShape(e.canvas.width/2-125,e.canvas.height-50,250,16);e.fillStyle=this.textColor,e.lineWidth=2,e.strokeRect(i.x,i.y,i.w,i.h);var n=t/10,r=new s.CanvasShape(e.canvas.width/2-125,e.canvas.height-50,n*=250,16);e.fillStyle="rgba(0,225,0,0.5)",e.fillRect(r.x,r.y,r.w,r.h)},e.prototype.volumeHud=function(e){e.drawImage(this.volumeImageObj,0,0),e.drawImage(this.nextImageObj,20,0)},e.prototype.pauseVolume=function(e){this.volumeImageObj.src=e?this.volPaused:this.volOn},e.prototype.addCount=function(e,t){var i=new s.CanvasText("+1",t.X,t.Y,this.textColor,"15px Arial");e.font=i.font,e.fillStyle=i.color,e.strokeStyle=i.color,e.fillText(i.word,i.x,i.y)},e.prototype.splashScreen=function(e){var t=this;this.clearGUI();var i=document.createElement("LABEL");i.innerText="DRONES",i.setAttribute("style","color:lime;font:40px Verdana;font-weight: 700;");var s=document.createElement("BUTTON");s.innerText="START",s.id="startBtn",s.setAttribute("style",this.getButtonStyle(!1)),s.onclick=function(){e.start(),t.clearGUI()},s.onmouseover=function(){s.setAttribute("style",t.getButtonStyle(!0))},s.onmouseleave=function(){s.setAttribute("style",t.getButtonStyle(!1))};var n=document.createElement("LABEL");n.setAttribute("style","color:lime;font:16px Verdana;bottom: 0;"),n.innerText="Arrows to move; Spacebar to shoot; left ctrl for missiles";var r=this.getNewLineElem(5);this.guiBox.insertAdjacentElement("afterbegin",r),r.insertAdjacentElement("afterend",i);var o=this.getNewLineElem(25);i.insertAdjacentElement("afterend",o),o.insertAdjacentElement("afterend",s);var a=this.getNewLineElem(150);s.insertAdjacentElement("afterend",a),a.insertAdjacentElement("afterend",n)},e.prototype.pauseScreen=function(e){this.clearGUI();var t=document.createElement("LABEL");t.innerText="PAUSED",t.setAttribute("style","color:lime;font:40px Verdana;"),this.guiBox.insertAdjacentElement("afterbegin",t)},e.prototype.gameOverScreen=function(e){var t=this;this.clearGUI();var i=document.createElement("LABEL");i.innerText="GAME OVER",i.setAttribute("style","color:lime;font:40px Verdana;");var s=document.createElement("BUTTON");s.innerText="RESET",s.id="resetBtn",s.setAttribute("style",this.getButtonStyle(!1)),s.onclick=function(){t.clearGUI(),e.reset()},s.onmouseover=function(){s.setAttribute("style",t.getButtonStyle(!0))},s.onmouseleave=function(){s.setAttribute("style",t.getButtonStyle(!1))},this.guiBox.insertAdjacentElement("afterbegin",i);var n=this.getNewLineElem(25);i.insertAdjacentElement("afterend",n),n.insertAdjacentElement("afterend",s)},e.prototype.createGUI=function(){var e=window.document.getElementById("canvasElem"),t=window.document.createElement("DIV");t.id="gui",t.setAttribute("style","position:absolute;top:0;float:left; width:99%;height:99vh;text-align:center;z-index:5;"),e.insertAdjacentElement("afterend",t),this.guiBox=window.document.createElement("DIV"),this.guiBox.id="guiBox",this.guiBox.setAttribute("style","float:left;color:lime;margin-top:15%;height:50%;width:100%;text-align:center;"),t.insertAdjacentElement("afterbegin",this.guiBox)},e.prototype.clearGUI=function(){for(;this.guiBox.firstChild;)this.guiBox.removeChild(this.guiBox.firstChild)},e.prototype.getNewLineElem=function(e){var t=document.createElement("DIV");return t.setAttribute("style","height:"+e+"px;"),t},e.prototype.getButtonStyle=function(e){return e?"color:black;font:20px Verdana;font-weight: 700;background-color:lime;border:2px solid lime;width:15%;height:50px;transition:.6s;cursor:pointer;box-shadow:0 0 25px lime;border-radius: 12px;":"color:lime;font:20px Verdana;font-weight: 700;background-color:black;border:2px solid lime;width:15%;height:50px;transition:.3s;cursor:pointer;box-shadow:0 0 15px lime;border-radius: 12px;"},e}();t.Hud=n,function(e){e[e.SPLASH=0]="SPLASH",e[e.PAUSE=1]="PAUSE",e[e.GAME_OVER=2]="GAME_OVER"}(t.SCREEN_ACTIONS||(t.SCREEN_ACTIONS={}))}),define("services/audio.service",["require","exports","services/asset-manager"],function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(){var e=this;this.song=0,this.musicVolume=.3,this.playlist=[i.ASSETS.PREPEND+"sounds/PatrickLieberkind-1.wav",i.ASSETS.PREPEND+"sounds/PatrickLieberkind-2.wav",i.ASSETS.PREPEND+"sounds/PatrickLieberkind-3.wav"],this.audioElem=new Audio,this.missleElem=new Audio,this.lazorElem=new Audio,this.audioElem.onended=function(){setTimeout(function(){e.next()},1e4)}}return e.prototype.toggle=function(e){e?this.audioElem.pause():(this.audioElem.volume=this.musicVolume,this.audioElem.play())},e.prototype.next=function(){this.song++,this.song>=this.playlist.length&&(this.song=0),this.audioElem.pause(),this.audioElem.src=this.playlist[this.song],this.audioElem.volume=this.musicVolume,this.audioElem.play()},e.prototype._noiseFireMissile=function(){this.missleElem.pause(),this.missleElem.src=i.ASSETS.PREPEND+"sounds/fireMissle.wav",this.missleElem.volume=.3,this.missleElem.play()},e.prototype._noiseFireZeLazor=function(){this.lazorElem.pause(),this.lazorElem.src=i.ASSETS.PREPEND+"sounds/laser.wav",this.lazorElem.volume=.02,this.lazorElem.play()},e}();t.AudioService=s}),define("services/drones-manager.service",["require","exports","model/player","services/key-status","model/enemy-drones","model/powerups","model/missile","model/boss.drones","model/hud","services/audio.service"],function(e,t,i,s,n,r,o,a,l,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(){this.hud=new l.Hud,this.player=new i.Player,this.keyHandler=new s.KeyDown,this.powerUp=new r.Powerup,this.playerMissile=new o.Missile(!1),this.boss=new a.Boss,this.soundService=new h.AudioService,this.dT=0,this.pauseGame=!1,this.playerRoF=0,this.playerBullets=[],this.enemyFleet=[],this.enemyBullets=[],this.GAME_DIFFICULTY=.04,this.GameOver=!1,this.KILLS=0}return e.prototype.keyChange=function(e,t){13!==e||t||(this.pauseGame=!this.pauseGame),this.keyHandler.keyChange(e,t)},e.prototype.update=function(e,t){this.dT=t,this.updateUserLocations(e),this.updateProjectileLocations(e),this.updateEnemiesLocation(e),this.randomizedGameElements(e),this.checkCollitions(e)},e.prototype.draw=function(e){var t=this;this.player.draw(e),this.powerUp.active&&this.powerUp.draw(e),this.powerUp.showText&&this.hud.displayText(e,this.powerUp.getFlashText()),(this.playerMissile.activeMissile||this.playerMissile.explodingMissile)&&this.playerMissile.draw(e),this.playerBullets.forEach(function(t){t.draw(e)}),this.enemyFleet.forEach(function(i){i.draw(e),i.hasBeenShot&&i.active&&t.hud.addCount(e,i)}),(this.boss.active||this.boss.explodingBoss)&&this.boss.draw(e),this.enemyBullets.forEach(function(t){t.draw(e)}),this.hud.playerStats(e,this.player,this.KILLS),this.hud.volumeHud(e),this.player.hasShield&&this.hud.drawShieldTick(e,this.player.shieldTick)},e.prototype.updateUserLocations=function(e){this.player.update(e,this.keyHandler,this.dT)},e.prototype.updateProjectileLocations=function(e){var t=this;this.keyHandler.isShooting()&&(0===this.playerRoF&&(this.playerBullets=this.player.shoot(this.playerBullets),this.soundService._noiseFireZeLazor()),this.player.hasRoFpowerUp?this.playerRoF=0:(this.playerRoF++,5===this.playerRoF&&(this.playerRoF=0))),this.playerBullets.forEach(function(i){i.update(e,null,t.dT),t.player.hasSprayPowerUp&&i.powerUpCycle()}),this.playerBullets=this.playerBullets.filter(function(e){return e.active}),this.enemyBullets=this.enemyBullets.filter(function(e){return e.active}),this.playerMissile.activeMissile||!this.keyHandler.isFireZeMissiles()||this.playerMissile.explodingMissile||(this.playerMissile.activeMissile=!0,this.playerMissile.X=this.player.X,this.playerMissile.Y=this.player.Y,this.soundService._noiseFireMissile()),this.playerMissile.activeMissile&&this.playerMissile.update(e,null,this.dT),this.powerUp.active&&this.powerUp.update(e,null,this.dT)},e.prototype.updateEnemiesLocation=function(e){var t=this;Math.random()<this.GAME_DIFFICULTY+.02&&this.enemyFleet.push(new n.Enemy(200,e.canvas.width-30,e.canvas.width/12+Math.random()*e.canvas.width/3)),this.enemyFleet.forEach(function(i){i.update(e,null,t.dT)}),this.enemyFleet=this.enemyFleet.filter(function(e){return e.active}),this.boss.active&&(this.boss.update(e,this.keyHandler,this.dT),Math.random()<this.GAME_DIFFICULTY&&(this.enemyBullets=this.boss.shoot(this.enemyBullets))),this.enemyBullets.forEach(function(i){i.update(e,null,t.dT),i.powerUpCycle()})},e.prototype.randomizedGameElements=function(e){this.powerUp.active||1e4*Math.random()<40&&(this.powerUp.active=!0,this.powerUp.X=e.canvas.width,this.powerUp.Y=this.getRandomHeight(e)),this.boss.active||this.KILLS%273==0&&0!==this.KILLS&&(this.boss.active=!0,this.boss.health=500,this.boss.X=e.canvas.width-300,this.boss.Y=e.canvas.height/2)},e.prototype.checkCollitions=function(e){var t=this;if(this.enemyFleet.forEach(function(e){e.hasBeenShot||t.playerBullets.forEach(function(i){t.collides(e,i)&&(t.KILLS++,e.explode(),i.active=!1)})}),this.enemyFleet.forEach(function(i){i.hasBeenShot||(t.collides(i,t.player)&&(i.explode(),t.player.hasShield||t.removePowerups(),t.GameOver=t.player.explode()),t.playerMissile.activeMissile&&t.collides(t.playerMissile,i)&&(t.KILLS++,i.explode(),t.playerMissile.destroy(e),t.enemyFleet.forEach(function(e){t.bombCollides(t.playerMissile,e,t.playerMissile.explosionVelocity)&&(t.KILLS++,e.explode())})))}),this.powerUp.active&&this.collides(this.player,this.powerUp)){switch(this.powerUp.type){case r.PowerUpType.Spray:this.player.hasSprayPowerUp=!0;break;case r.PowerUpType.Health:this.player.addHealth(10);break;case r.PowerUpType.explosionVelocity:this.player.hasExplosionVelocity=!0,this.playerMissile.explosionVelocity=400;break;case r.PowerUpType.RoF:this.player.hasRoFpowerUp=!0;break;case r.PowerUpType.Shield:this.player.activateShield()}this.powerUp.flashInfo(this.powerUp.type),this.powerUp.active=!1,this.powerUp.X=e.canvas.width,this.powerUp.getNewType()}this.boss.active&&(this.playerBullets.forEach(function(e){t.collides(t.boss,e)&&(t.boss.health--,t.boss.health<=0&&(t.boss.active=!1),e.active=!1)}),this.playerMissile.activeMissile&&this.collides(this.playerMissile,this.boss)&&(this.boss.health-=this.player.hasExplosionVelocity?100:50,this.playerMissile.destroy(e),this.boss.health<=0&&this.boss.destroy(e),this.enemyFleet.forEach(function(e){t.bombCollides(t.playerMissile,e,t.playerMissile.explosionVelocity)&&(t.KILLS++,e.explode())}))),this.enemyBullets.forEach(function(e){t.collides(e,t.player)&&(e.active=!1,t.player.hasShield||t.removePowerups(),t.GameOver=t.player.explode())}),this.playerMissile.needMissile&&(this.playerMissile=new o.Missile(this.player.hasExplosionVelocity)),this.KILLS>100&&.07!==this.GAME_DIFFICULTY&&(this.GAME_DIFFICULTY=.07,this.hud.showLevelText="Level 2"),this.KILLS>500&&.13!==this.GAME_DIFFICULTY&&(this.GAME_DIFFICULTY=.13,this.hud.showLevelText="Level 3")},e.prototype.collides=function(e,t){return e.X<t.X+t.Width&&e.X+e.Width>t.X&&e.Y<t.Y+t.Height&&e.Y+e.Height>t.Y},e.prototype.bombCollides=function(e,t,i){return e.X<t.X+i+t.Width&&e.X+e.Width>t.X-i&&e.Y<t.Y+i+t.Width&&e.Y+e.Height>t.Y-i},e.prototype.getRandomHeight=function(e){var t=Math.floor(1e3*Math.random())+1;return t<10&&(t=10),t%2==0&&(t+=100),t>e.canvas.height&&(t-=t-e.canvas.height),t>e.canvas.height-50&&(t=e.canvas.height-100),t},e.prototype.removePowerups=function(){this.player.losePowerUps(),this.playerMissile.explosionVelocity=this.playerMissile.defaultExplosionVelocity},e}();t.DronesManagerService=c}),define("DronesCanvas",["require","exports","services/drones-manager.service","model/hud"],function(e,t,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=this;this.canvasElementName=e,this.currentTime=(new Date).getTime(),this.lastTime=(new Date).getTime(),this.interval=1e3/30,this.audioPause=!1,this.canvasButtonList=[],this.loop=function(){if(t.gameManager.GameOver||t.gameManager.pauseGame)t.gameManager.GameOver&&t.buildCanvasGUI(s.SCREEN_ACTIONS.GAME_OVER);else{t.gameLoop=window.requestAnimationFrame(t.loop);var e=(new Date).getTime();t.deltaTime=(e-t.lastTime)/1e3,t.deltaTime>.2&&(t.deltaTime=.018),t.CanvasObject.clearRect(0,0,t.CanvasObject.canvas.width,t.CanvasObject.canvas.height),t.gameManager.update(t.CanvasObject,t.deltaTime),t.gameManager.draw(t.CanvasObject),t.lastTime=e-t.deltaTime%t.interval}},this.CanvasObject=e.getContext("2d"),this.gameManager=new i.DronesManagerService,this.audioService=this.gameManager.soundService}return e.prototype.init=function(){var e=this;window.document.body.style.backgroundColor="black";var t=this.getWindowSize();this.CanvasObject.canvas.width=t[0]-15,this.CanvasObject.canvas.height=t[1]-25,this.hud=this.gameManager.hud,this.buildCanvasGUI(s.SCREEN_ACTIONS.SPLASH),document.addEventListener("keydown",function(t){e.gameManager.keyChange(t.keyCode,!0)}),document.addEventListener("keyup",function(t){e.gameManager.keyChange(t.keyCode,!1),13===t.keyCode&&(e.gameManager.pauseGame?e.buildCanvasGUI(s.SCREEN_ACTIONS.PAUSE):(e.hud.clearGUI(),e.loop()))}),window.addEventListener("resize",function(){var t=e.getWindowSize();e.CanvasObject.canvas.width=t[0]-15,e.CanvasObject.canvas.height=t[1]-25}),this.canvasElementName.addEventListener("click",function(e){})},e.prototype.start=function(){this.gameManager.GameOver=!1,this.audioService.next(),this.loop()},e.prototype.reset=function(){window.cancelAnimationFrame(this.gameLoop),this.gameManager=new i.DronesManagerService,this.buildCanvasGUI(s.SCREEN_ACTIONS.SPLASH)},e.prototype.getWindowSize=function(){var e=0,t=0;return"number"==typeof window.innerWidth?(e=window.innerWidth,t=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(e=document.documentElement.clientWidth,t=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(e=document.body.clientWidth,t=document.body.clientHeight),[e,t]},e.prototype.setDifficulty=function(e){switch(e){case 1:this.gameManager.GAME_DIFFICULTY=.04;break;case 2:this.gameManager.GAME_DIFFICULTY=.07;break;case 3:this.gameManager.GAME_DIFFICULTY=.13;break;default:this.gameManager.GAME_DIFFICULTY=.07}this.gameManager.playerRoF=0},e.prototype.buildCanvasGUI=function(e){switch(this.canvasButtonList=[],e){case s.SCREEN_ACTIONS.SPLASH:this.hud.splashScreen(this);break;case s.SCREEN_ACTIONS.PAUSE:this.hud.pauseScreen(this);break;case s.SCREEN_ACTIONS.GAME_OVER:this.hud.gameOverScreen(this)}},e}();t.DronesCanvas=n});